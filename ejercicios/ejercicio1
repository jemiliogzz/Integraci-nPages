<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ejercicio 1: Clasificaci√≥n de d√≠gitos con CNN</title>
  <link rel="stylesheet" href="../style.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css">
</head>
<body>
  <header>
    <h1>Ejercicio 1: Clasificaci√≥n de d√≠gitos con CNN</h1>
    <nav>
      <a href="../index.html">Inicio</a>
      <a href="../ejercicios.html">Ejercicios</a>
    </nav>
  </header>

  <main>
    <section>
      <h2>Descripci√≥n</h2>
      <p>Ejercicio realizado en clase.</p>
      <ul>
        <li><a href="ejercicios/ejercicio1.py">Ejercicio 1: Clasificaci√≥n de d√≠gitos con CNN (ver c√≥digo)</a></li>
      </ul>
    </section>

    <section>
      <h2>C√≥digo</h2>
      <pre><code class="language-python">
# Clasificador mejorado de modelos de servicio en la nube: IaaS, SaaS, FaaS
# Incluye Machine Learning para mejor clasificaci√≥n

import re
from collections import Counter
from sklearn.feature_extraction.text import TfidfVectorizer
from sklearn.naive_bayes import MultinomialNB
from sklearn.pipeline import Pipeline
from sklearn.model_selection import train_test_split
import pickle
import os

# Datos de entrenamiento para Machine Learning
TRAINING_DATA = [
    # IaaS examples
    ("Amazon EC2 proporciona servidores virtuales para desplegar aplicaciones", "IaaS"),
    ("Microsoft Azure Virtual Machines te permite crear m√°quinas virtuales", "IaaS"),
    ("Google Compute Engine ofrece instancias de computaci√≥n escalables", "IaaS"),
    ("AWS S3 es un servicio de almacenamiento de objetos en la nube", "IaaS"),
    ("DigitalOcean proporciona droplets que son servidores virtuales", "IaaS"),
    ("Alquila capacidad computacional en la nube sin gestionar hardware", "IaaS"),
    ("Servicio que te permite provisionar recursos de infraestructura", "IaaS"),
    ("Plataforma que proporciona m√°quinas virtuales y almacenamiento", "IaaS"),
    ("Recursos computacionales que puedes alquilar por hora", "IaaS"),
    ("Infraestructura de red y servidores virtualizados", "IaaS"),
    
    # SaaS examples
    ("Google Docs permite editar documentos en l√≠nea desde el navegador", "SaaS"),
    ("Salesforce es una plataforma CRM para gesti√≥n de clientes", "SaaS"),
    ("Microsoft 365 incluye Word, Excel y PowerPoint en la nube", "SaaS"),
    ("Slack es una herramienta de colaboraci√≥n en tiempo real", "SaaS"),
    ("Zoom permite videoconferencias sin instalar software", "SaaS"),
    ("Herramienta que puedes usar desde tu navegador sin instalar nada", "SaaS"),
    ("Aplicaci√≥n web que se actualiza autom√°ticamente", "SaaS"),
    ("Software que sincroniza tus datos en la nube", "SaaS"),
    ("Soluci√≥n completa accesible desde cualquier dispositivo", "SaaS"),
    ("Interfaz de usuario que no requiere instalaci√≥n local", "SaaS"),
    
    # FaaS examples
    ("AWS Lambda ejecuta funciones en respuesta a eventos sin gestionar servidores", "FaaS"),
    ("Azure Functions permite ejecutar c√≥digo bajo demanda", "FaaS"),
    ("Google Cloud Functions ejecuta c√≥digo en respuesta a eventos", "FaaS"),
    ("C√≥digo que se ejecuta autom√°ticamente cuando ocurre algo espec√≠fico", "FaaS"),
    ("Funci√≥n que se activa cuando llega un archivo", "FaaS"),
    ("Sistema que ejecuta tu c√≥digo temporalmente cuando lo necesitas", "FaaS"),
    ("Procesamiento autom√°tico de eventos sin servidores permanentes", "FaaS"),
    ("C√≥digo que responde a triggers espec√≠ficos", "FaaS"),
    ("Ejecuci√≥n temporal de funciones en la nube", "FaaS"),
    ("Serverless computing para procesamiento de eventos", "FaaS"),
]

class CloudModelClassifier:
    def __init__(self):
        self.ml_model = None
        self.vectorizer = None
        self.is_trained = False
        
    def preprocess_text(self, texto):
        """Preprocesa el texto para ML"""
        if not texto:
            return ""
        # Convertir a min√∫sculas y limpiar
        texto = texto.lower()
        # Remover caracteres especiales pero mantener espacios
        texto = re.sub(r'[^\w\s]', ' ', texto)
        # Remover espacios extra
        texto = ' '.join(texto.split())
        return texto
    
    def train_model(self, training_data=None):
        """Entrena el modelo de Machine Learning"""
        if training_data is None:
            training_data = TRAINING_DATA
            
        # Separar textos y etiquetas
        texts = [self.preprocess_text(text) for text, _ in training_data]
        labels = [label for _, label in training_data]
        
        # Crear pipeline con TF-IDF y Naive Bayes
        self.ml_model = Pipeline([
            ('tfidf', TfidfVectorizer(max_features=1000, ngram_range=(1, 2))),
            ('classifier', MultinomialNB())
        ])
        
        # Entrenar el modelo
        self.ml_model.fit(texts, labels)
        self.is_trained = True
        
        print("‚úÖ Modelo de Machine Learning entrenado exitosamente")
    
    def predict_ml(self, texto):
        """Predice usando Machine Learning"""
        if not self.is_trained:
            return None
            
        processed_text = self.preprocess_text(texto)
        if not processed_text:
            return None
            
        try:
            prediction = self.ml_model.predict([processed_text])[0]
            confidence = max(self.ml_model.predict_proba([processed_text])[0])
            return prediction, confidence
        except:
            return None
    
    def save_model(self, filename='cloud_classifier_model.pkl'):
        """Guarda el modelo entrenado"""
        if self.is_trained:
            with open(filename, 'wb') as f:
                pickle.dump(self.ml_model, f)
            print(f"‚úÖ Modelo guardado en {filename}")
    
    def load_model(self, filename='cloud_classifier_model.pkl'):
        """Carga un modelo pre-entrenado"""
        if os.path.exists(filename):
            with open(filename, 'rb') as f:
                self.ml_model = pickle.load(f)
            self.is_trained = True
            print(f"‚úÖ Modelo cargado desde {filename}")
            return True
        return False

# Instancia global del clasificador ML
ml_classifier = CloudModelClassifier()

def es_iaas(texto):
    """
    Determina si el texto corresponde a IaaS (Infrastructure as a Service).
    Args:
        texto (str): Descripci√≥n del servicio o producto en la nube.
    Returns:
        bool: True si corresponde a IaaS, False en caso contrario.
    """
    # Palabras clave directas
    iaas_keywords = [
        'infraestructura', 'servidor', 'virtual machine', 'vm', 'almacenamiento', 
        'red', 'network', 'hardware', 'computo', 'virtualizaci√≥n', 'virtualization', 
        'ec2', 'vps', 'disco duro', 'cpu', 'ram', 'instancia', 'm√°quina virtual'
    ]
    
    # Patrones descriptivos m√°s flexibles
    iaas_patterns = [
        'proporciona recursos', 'gestiona servidores', 'alquila servidores',
        'm√°quinas virtuales', 'recursos computacionales', 'capacidad de procesamiento',
        'espacio de almacenamiento', 'redes y conectividad', 'infraestructura de red',
        'sistema operativo', 'plataforma de hosting', 'datacenter', 'centro de datos',
        'recursos f√≠sicos', 'hardware virtualizado', 'provisionamiento de recursos'
    ]
    
    # Verificar palabras clave directas
    if any(palabra in texto for palabra in iaas_keywords):
        return True
    
    # Verificar patrones descriptivos
    if any(patron in texto for patron in iaas_patterns):
        return True
    
    return False

def es_saas(texto):
    """
    Determina si el texto corresponde a SaaS (Software as a Service).
    Args:
        texto (str): Descripci√≥n del servicio o producto en la nube.
    Returns:
        bool: True si corresponde a SaaS, False en caso contrario.
    """
    # Palabras clave directas
    saas_keywords = [
        'software', 'aplicaci√≥n', 'app', 'servicio en la nube', 'correo', 
        'email', 'crm', 'erp', 'ofim√°tica', 'office', 'google docs', 
        'salesforce', 'usuario final', 'web', 'navegador', 'browser', 
        'plataforma', 'gesti√≥n', 'colaboraci√≥n', 'herramienta', 'suite'
    ]
    
    # Patrones descriptivos m√°s flexibles
    saas_patterns = [
        'acceso desde navegador', 'aplicaci√≥n web', 'software como servicio',
        'herramienta en l√≠nea', 'soluci√≥n completa', 'interfaz de usuario',
        'usado por usuarios finales', 'no requiere instalaci√≥n', 'acceso inmediato',
        'suscripci√≥n mensual', 'pago por uso', 'actualizaciones autom√°ticas',
        'colaboraci√≥n en tiempo real', 'almacenamiento en la nube', 'sincronizaci√≥n'
    ]
    
    # Verificar palabras clave directas
    if any(palabra in texto for palabra in saas_keywords):
        return True
    
    # Verificar patrones descriptivos
    if any(patron in texto for patron in saas_patterns):
        return True
    
    return False

def es_faas(texto):
    """
    Determina si el texto corresponde a FaaS (Function as a Service).
    Args:
        texto (str): Descripci√≥n del servicio o producto en la nube.
    Returns:
        bool: True si corresponde a FaaS, False en caso contrario.
    """
    # Palabras clave directas
    faas_keywords = [
        'funci√≥n', 'eventos', 'serverless', 'lambda', 'ejecuci√≥n bajo demanda', 
        'c√≥digo bajo demanda', 'event-driven', 'sin servidor', 'invocaci√≥n', 
        'runtime', 'microservicio', 'microservicios', 'trigger', 'gatillo'
    ]
    
    # Patrones descriptivos m√°s flexibles
    faas_patterns = [
        'ejecuta c√≥digo', 'respuesta a eventos', 'sin gestionar servidores',
        'c√≥digo que se ejecuta', 'funci√≥n que se activa', 'procesamiento autom√°tico',
        'ejecuci√≥n temporal', 'c√≥digo que responde', 'funci√≥n que procesa',
        'activaci√≥n autom√°tica', 'procesamiento bajo demanda', 'c√≥digo reactivo',
        'funci√≥n que se ejecuta', 'c√≥digo que se activa', 'procesamiento de eventos'
    ]
    
    # Verificar palabras clave directas
    if any(palabra in texto for palabra in faas_keywords):
        return True
    
    # Verificar patrones descriptivos
    if any(patron in texto for patron in faas_patterns):
        return True
    
    return False

def clasificar_modelo_cloud(texto, use_ml=True):
    """
    Clasifica el texto como IaaS, SaaS o FaaS usando reglas b√°sicas y ML.
    Args:
        texto (str): Descripci√≥n del servicio o producto en la nube.
        use_ml (bool): Si usar Machine Learning adem√°s de reglas b√°sicas.
    Returns:
        str: 'IaaS', 'SaaS', 'FaaS', 'Desconocido' o 'Entrada inv√°lida'
    """
    # Validaci√≥n de entrada
    if not isinstance(texto, str) or not texto.strip():
        return 'Entrada inv√°lida'
    
    texto_lower = texto.lower()
    
    # Primero intentar con reglas b√°sicas
    if es_iaas(texto_lower):
        return 'IaaS'
    if es_saas(texto_lower):
        return 'SaaS'
    if es_faas(texto_lower):
        return 'FaaS'
    
    # Si las reglas b√°sicas no funcionan y ML est√° habilitado, usar ML
    if use_ml and ml_classifier.is_trained:
        ml_result = ml_classifier.predict_ml(texto)
        if ml_result:
            prediction, confidence = ml_result
            # Solo usar ML si la confianza es alta (>0.6)
            if confidence > 0.6:
                return prediction
    
    return 'Desconocido'

def clasificar_modelo_cloud_avanzado(texto, use_ml=True, confidence_threshold=0.6):
    """
    Clasificaci√≥n avanzada que incluye confianza del modelo ML.
    Args:
        texto (str): Descripci√≥n del servicio o producto en la nube.
        use_ml (bool): Si usar Machine Learning.
        confidence_threshold (float): Umbral de confianza para ML (0.0-1.0).
    Returns:
        dict: {'clasificacion': str, 'confianza': float, 'metodo': str}
    """
    # Validaci√≥n de entrada
    if not isinstance(texto, str) or not texto.strip():
        return {'clasificacion': 'Entrada inv√°lida', 'confianza': 0.0, 'metodo': 'validacion'}
    
    texto_lower = texto.lower()
    
    # Intentar con reglas b√°sicas primero
    if es_iaas(texto_lower):
        return {'clasificacion': 'IaaS', 'confianza': 0.9, 'metodo': 'reglas_basicas'}
    if es_saas(texto_lower):
        return {'clasificacion': 'SaaS', 'confianza': 0.9, 'metodo': 'reglas_basicas'}
    if es_faas(texto_lower):
        return {'clasificacion': 'FaaS', 'confianza': 0.9, 'metodo': 'reglas_basicas'}
    
    # Si las reglas b√°sicas no funcionan y ML est√° habilitado
    if use_ml and ml_classifier.is_trained:
        ml_result = ml_classifier.predict_ml(texto)
        if ml_result:
            prediction, confidence = ml_result
            if confidence > confidence_threshold:
                return {'clasificacion': prediction, 'confianza': confidence, 'metodo': 'machine_learning'}
    
    return {'clasificacion': 'Desconocido', 'confianza': 0.0, 'metodo': 'ninguno'}

# Funci√≥n para inicializar y entrenar el modelo
def inicializar_clasificador_ml():
    """Inicializa y entrena el clasificador de Machine Learning"""
    print("ü§ñ Inicializando clasificador de Machine Learning...")
    
    # Intentar cargar modelo existente
    if ml_classifier.load_model():
        return True
    
    # Si no existe, entrenar nuevo modelo
    print("üìö Entrenando nuevo modelo con datos de ejemplo...")
    ml_classifier.train_model()
    ml_classifier.save_model()
    return True

def mostrar_menu():
    """Muestra el men√∫ principal de opciones"""
    print("\n" + "="*60)
    print("üå©Ô∏è  CLASIFICADOR DE MODELOS DE SERVICIO EN LA NUBE")
    print("="*60)
    print("1. Clasificaci√≥n b√°sica (solo reglas)")
    print("2. Clasificaci√≥n con Machine Learning")
    print("3. Clasificaci√≥n avanzada (con confianza)")
    print("4. Ver ejemplos de uso")
    print("5. Salir")
    print("="*60)

def mostrar_ejemplos():
    """Muestra ejemplos de uso del clasificador"""
    print("\nüìö EJEMPLOS DE USO:")
    print("-" * 40)
    
    ejemplos = [
        ("Amazon EC2 proporciona servidores virtuales", "IaaS"),
        ("Google Docs permite editar documentos en l√≠nea", "SaaS"),
        ("AWS Lambda ejecuta funciones en respuesta a eventos", "FaaS"),
        ("Servicio que te permite alquilar capacidad computacional", "IaaS"),
        ("Herramienta que puedes usar desde tu navegador", "SaaS"),
        ("C√≥digo que se ejecuta autom√°ticamente", "FaaS"),
    ]
    
    for texto, categoria in ejemplos:
        print(f"Texto: {texto}")
        print(f"Categor√≠a esperada: {categoria}")
        print("-" * 40)

def procesar_clasificacion(texto, tipo_clasificacion):
    """Procesa la clasificaci√≥n seg√∫n el tipo seleccionado"""
    print(f"\nüîç Analizando: '{texto}'")
    print("-" * 50)
    
    if tipo_clasificacion == 1:
        # Clasificaci√≥n b√°sica
        resultado = clasificar_modelo_cloud(texto, use_ml=False)
        print(f"üìä Resultado: {resultado}")
        print(f"üîß M√©todo: Reglas b√°sicas")
        
    elif tipo_clasificacion == 2:
        # Clasificaci√≥n con ML
        resultado = clasificar_modelo_cloud(texto, use_ml=True)
        print(f"üìä Resultado: {resultado}")
        print(f"ü§ñ M√©todo: H√≠brido (Reglas + ML)")
        
    elif tipo_clasificacion == 3:
        # Clasificaci√≥n avanzada
        resultado = clasificar_modelo_cloud_avanzado(texto)
        print(f"üìä Resultado: {resultado['clasificacion']}")
        print(f"üìà Confianza: {resultado['confianza']:.2f}")
        print(f"üîß M√©todo: {resultado['metodo']}")
        
        # Explicaci√≥n adicional
        if resultado['clasificacion'] != 'Desconocido':
            explicaciones = {
                'IaaS': 'Infrastructure as a Service - Proporciona recursos de infraestructura como servidores, almacenamiento y redes.',
                'SaaS': 'Software as a Service - Ofrece aplicaciones completas accesibles desde el navegador.',
                'FaaS': 'Function as a Service - Ejecuta c√≥digo espec√≠fico en respuesta a eventos.'
            }
            print(f"üí° Explicaci√≥n: {explicaciones.get(resultado['clasificacion'], '')}")

def interfaz_usuario():
    """Interfaz interactiva para el usuario"""
    print("üöÄ Bienvenido al Clasificador de Modelos de Servicio en la Nube")
    print("Este sistema puede clasificar servicios como IaaS, SaaS o FaaS")
    
    # Inicializar ML
    inicializar_clasificador_ml()
    
    while True:
        mostrar_menu()
        
        try:
            opcion = input("\nSelecciona una opci√≥n (1-5): ").strip()
            
            if opcion == "1" or opcion == "2" or opcion == "3":
                print(f"\nüìù Ingresa la descripci√≥n del servicio que quieres clasificar:")
                texto = input("> ").strip()
                
                if texto:
                    procesar_clasificacion(texto, int(opcion))
                else:
                    print("‚ùå Por favor ingresa un texto v√°lido.")
                    
            elif opcion == "4":
                mostrar_ejemplos()
                
            elif opcion == "5":
                print("\nüëã ¬°Gracias por usar el clasificador!")
                break
                
            else:
                print("‚ùå Opci√≥n no v√°lida. Por favor selecciona 1-5.")
                
        except KeyboardInterrupt:
            print("\n\nüëã ¬°Hasta luego!")
            break
        except Exception as e:
            print(f"‚ùå Error: {e}")

# Ejemplo de uso
if __name__ == "__main__":
    # Para ejecutar el programa en modo interactivo, ejecutar el siguiente comando:
    # python cloud_models_classifier.py

    # Para ejecutar el programa en modo de prueba, ejecutar el siguiente comando:
    # python cloud_models_classifier.py --test

    # Verificar si se ejecuta en modo interactivo o de prueba
    import sys
    
    if len(sys.argv) > 1 and sys.argv[1] == "--test":
        # Modo de prueba autom√°tica
        inicializar_clasificador_ml()
        
        ejemplos = [
            # Ejemplos con palabras clave directas
            "Amazon EC2 proporciona servidores virtuales para desplegar aplicaciones.",
            "Google Docs permite editar documentos en l√≠nea desde el navegador.",
            "AWS Lambda ejecuta funciones en respuesta a eventos sin gestionar servidores.",
            
            # Ejemplos con descripciones m√°s naturales (sin palabras clave exactas)
            "Servicio que te permite alquilar capacidad computacional en la nube.",
            "Herramienta que puedes usar desde tu navegador sin instalar nada.",
            "C√≥digo que se ejecuta autom√°ticamente cuando ocurre algo espec√≠fico.",
            "Plataforma que proporciona recursos f√≠sicos virtualizados.",
            "Aplicaci√≥n que se actualiza autom√°ticamente y sincroniza tus datos.",
            "Sistema que ejecuta tu c√≥digo temporalmente cuando lo necesitas.",
            
            # Casos de prueba de validaci√≥n
            "",  # Caso de entrada vac√≠a
            None,  # Caso de entrada None
            12345,  # Caso de entrada no string
        ]
        
        print("üîç Probando clasificaci√≥n b√°sica:")
        for texto in ejemplos:
            resultado = clasificar_modelo_cloud(texto)
            print(f"Texto: {texto}\nClasificaci√≥n: {resultado}\n")
        
        print("\nü§ñ Probando clasificaci√≥n avanzada con ML:")
        for texto in ejemplos:
            if texto:  # Solo probar textos v√°lidos
                resultado = clasificar_modelo_cloud_avanzado(texto)
                print(f"Texto: {texto}")
                print(f"Clasificaci√≥n: {resultado['clasificacion']}")
                print(f"Confianza: {resultado['confianza']:.2f}")
                print(f"M√©todo: {resultado['metodo']}\n")
    else:
        # Modo interactivo
        interfaz_usuario()

      </code></pre>
    </section>
  </main>

  <footer>
    <p>¬© 2025 - Mi Sitio Personal</p>
  </footer>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
</body>
</html>
